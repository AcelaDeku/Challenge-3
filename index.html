document.addEventListener("DOMContentLoaded", function () {
  const amiiboList = document.getElementById("amiibo-list");

  // Fetch data from the JSON server
  fetch("http://localhost:3000/amiibo")
      .then(response => response.json())
      .then(data => {
          // Display fetched data on the webpage
          data.forEach(amiibo => {
              const amiiboCard = document.createElement("div");
              amiiboCard.classList.add("amiibo-card");
              amiiboCard.innerHTML = `
                  <img src="${amiibo.image}" alt="${amiibo.name}">
                  <p>${amiibo.name}</p>
                  <button class="add-to-cart" data-in-cart="false">Download</button>
                  <textarea class="comment" placeholder="Leave a comment"></textarea>
                  <button class="submit-feedback">Submit Feedback</button>
              `;
              amiiboList.appendChild(amiiboCard);
          });

          // Add event listener for "add to cart" button
          const addToCartButtons = document.querySelectorAll(".add-to-cart");
          addToCartButtons.forEach(button => {
              button.addEventListener("click", function () {
                  if (button.dataset.inCart === "false") {
                      button.textContent = "In Cart";
                      button.dataset.inCart = "true";
                  } else {
                      button.textContent = "Download";
                      button.dataset.inCart = "false";
                  }
              });
          });

          // Add event listener for "submit feedback" button
          const submitFeedbackButtons = document.querySelectorAll(".submit-feedback");
          submitFeedbackButtons.forEach(button => {
              button.addEventListener("click", function () {
                  const comment = button.previousElementSibling.value;
                  // Send comment to server or perform any desired action
                  console.log("Feedback submitted:", comment);
              });
          });
      })
      .catch(error => console.error("Error fetching data:", error));
});
